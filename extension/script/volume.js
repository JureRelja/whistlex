//volume slider
$("#volume-slider").slider({
    min: 0,
    max: 100,
    value: 50,
    range: "min",
    change: function(event, ui) { 
        setVolume(ui.value); 
    } 
});

//Set audio volume
function setVolume(volume) {
    if (volume === 0) {
        mute.attr("d","M508.886,323.143l-67.136-67.136l67.115-67.115c4.16-4.16,4.16-10.923,0-15.083c-4.16-4.16-10.923-4.16-15.083,0l-67.115,67.115l-67.115-67.115c-4.16-4.16-10.923-4.16-15.083,0c-4.16,4.16-4.16,10.923,0,15.083l67.115,67.115l-67.115,67.115c-4.16,4.16-4.16,10.923,0,15.083c2.069,2.091,4.8,3.136,7.531,3.136c2.731,0,5.461-1.045,7.552-3.115l67.115-67.136l67.115,67.115c2.091,2.091,4.821,3.136,7.552,3.136c2.731,0,5.461-1.045,7.552-3.115C513.046,334.065,513.046,327.303,508.886,323.143z");
        unmute.attr("d", "");
    }
    else {
        mute.attr("d", "M368.992,126.857c-6.304-6.208-16.416-6.112-22.624,0.128c-6.208,6.304-6.144,16.416,0.128,22.656C370.688,173.513,384,205.609,384,240.009s-13.312,66.496-37.504,90.368c-6.272,6.176-6.336,16.32-0.128,22.624c3.136,3.168,7.264,4.736,11.36,4.736c4.064,0,8.128-1.536,11.264-4.64C399.328,323.241,416,283.049,416,240.009S399.328,156.777,368.992,126.857z");
        unmute.attr("d", "M414.144,81.769c-6.304-6.24-16.416-6.176-22.656,0.096c-6.208,6.272-6.144,16.416,0.096,22.624C427.968,140.553,448,188.681,448,240.009s-20.032,99.424-56.416,135.488c-6.24,6.24-6.304,16.384-0.096,22.656c3.168,3.136,7.264,4.704,11.36,4.704c4.064,0,8.16-1.536,11.296-4.64C456.64,356.137,480,299.945,480,240.009S456.64,123.881,414.144,81.769z");
    }
    chrome.tabs.query({currentWindow: true, active: true}, function (tabs){
        var activeTab = tabs[0];
        chrome.tabs.sendMessage(activeTab.id, {volume: volume/100});
    });
};

//Messages from content.js
chrome.runtime.onMessage.addListener(function (message) {
    if(message.volume) {
        let currentVolume = message.volume * 100
        $('#volume-slider').slider("value", currentVolume);
    }
})

//Get elements
let mute = $("#first-line");
let unmute = $("#second-line");

//Mute-unmutemute
$(".mute-unmute").click(function() {
    if (mute.attr("d") === "M508.886,323.143l-67.136-67.136l67.115-67.115c4.16-4.16,4.16-10.923,0-15.083c-4.16-4.16-10.923-4.16-15.083,0l-67.115,67.115l-67.115-67.115c-4.16-4.16-10.923-4.16-15.083,0c-4.16,4.16-4.16,10.923,0,15.083l67.115,67.115l-67.115,67.115c-4.16,4.16-4.16,10.923,0,15.083c2.069,2.091,4.8,3.136,7.531,3.136c2.731,0,5.461-1.045,7.552-3.115l67.115-67.136l67.115,67.115c2.091,2.091,4.821,3.136,7.552,3.136c2.731,0,5.461-1.045,7.552-3.115C513.046,334.065,513.046,327.303,508.886,323.143z") {
        mute.attr("d", "M368.992,126.857c-6.304-6.208-16.416-6.112-22.624,0.128c-6.208,6.304-6.144,16.416,0.128,22.656C370.688,173.513,384,205.609,384,240.009s-13.312,66.496-37.504,90.368c-6.272,6.176-6.336,16.32-0.128,22.624c3.136,3.168,7.264,4.736,11.36,4.736c4.064,0,8.128-1.536,11.264-4.64C399.328,323.241,416,283.049,416,240.009S399.328,156.777,368.992,126.857z");
        unmute.attr("d", "M414.144,81.769c-6.304-6.24-16.416-6.176-22.656,0.096c-6.208,6.272-6.144,16.416,0.096,22.624C427.968,140.553,448,188.681,448,240.009s-20.032,99.424-56.416,135.488c-6.24,6.24-6.304,16.384-0.096,22.656c3.168,3.136,7.264,4.704,11.36,4.704c4.064,0,8.16-1.536,11.296-4.64C456.64,356.137,480,299.945,480,240.009S456.64,123.881,414.144,81.769z");
        $('#volume-slider').slider("value", 50);
    }
    else {
        mute.attr("d","M508.886,323.143l-67.136-67.136l67.115-67.115c4.16-4.16,4.16-10.923,0-15.083c-4.16-4.16-10.923-4.16-15.083,0l-67.115,67.115l-67.115-67.115c-4.16-4.16-10.923-4.16-15.083,0c-4.16,4.16-4.16,10.923,0,15.083l67.115,67.115l-67.115,67.115c-4.16,4.16-4.16,10.923,0,15.083c2.069,2.091,4.8,3.136,7.531,3.136c2.731,0,5.461-1.045,7.552-3.115l67.115-67.136l67.115,67.115c2.091,2.091,4.821,3.136,7.552,3.136c2.731,0,5.461-1.045,7.552-3.115C513.046,334.065,513.046,327.303,508.886,323.143z");
        unmute.attr("d", "");
        $('#volume-slider').slider("value", 0);
    }
    
});